!function(){function a(){var a={ret:1},b=[];if(1==a.ret){var c=$("div.login-hd"),d=a.data||{};b.push(['<div class="logined">','<div class="welcome">','<span class="username">'+(d.name||"zhangsan@163.com")+"</span>，欢迎使用","</div>",'<div class="user-opt">','<a href="javascript:;" class="icon modifypwd">修改密码</a>','<a href="javascript:;" class="icon logout">注销</a>',"</div>","</div>"].join("")),$("div.logined").size()>0?$("div.logined",c).show():c.append(b.join("")),$("div.loginbefore",c).hide()}}function b(a){var b=$(a),c=$.trim(b.val()||""),d=b.attr("id");if(b.parent().hasClass("login-item")&&(d=d.substring(1)),$msg_txt=b.siblings(".msg"),"oldpwd"==d){if(!c)return $msg_txt.html("旧密码不能为空").addClass("error").show(),void(l.oldpwd=!1);l.oldpwd=!0}else if("newpwd"==d){if(!c)return $msg_txt.html("新密码不能为空").addClass("error").show(),void(l.newpwd=!1);l.newpwd=!0}else if("renewpwd"==d){if(!c)return $msg_txt.html("重复密码不能为空").addClass("error").show(),l.newpwd=!1,void(l.repwd=!1);if(c!=$("#newpwd").val())return $msg_txt.html("与新密码不一致").addClass("error"),void(l.newpwd=!1);l.repwd=!0}$msg_txt.removeClass("error").hide()}function c(a){a||(a=$("body")),a.on("blur","input",function(){b($(this))})}var d="/yibaochelian/",e=document.location.href,f="http://115.159.77.210:8080/ybcl2.0/enterprise/",g=[],h=[],i=[],j=[],k=[],l={};k=e.indexOf("login.html")>-1||e.indexOf("reg.html")>-1?[]:['<div class="ad">','<img src="img/ad.png" />',"</div>"],g.push(['<div class="head">',"<h1>亦宝车联</h1>",k.join(""),'<div class="login-hd">','<div class="loginbefore">','<a href="javascript:;" class="btn-lgn">登录</a>','<a href="javascript:;" class="btn-reg">注册</a>',"</div>","</div>","</div>"].join("")),h.push(['<div class="foot">',"<p>京ICP备14024271号-1     Copyright @ YBCL 2014 Corporation, All rights Reserved</p>",'<div class="pin">','<img src="img/pin01.png" alt="">','<img src="img/pin02.png" alt="">',"</div>","</div>"].join("")),i.push(['<div class="nav-wrap">','<a href="'+d+'index.html" data-id="0">首页</a>','<span class="line">|</span>','<a href="'+d+'yuyuejiedai.html" data-id="1">VIP接待</a>','<span class="line">|</span>','<a href="'+d+'weixiujiedai.html" data-id="2">维修接待</a>','<span class="line">|</span>','<a href="'+d+'weixiulingliao.html" data-id="3">维修领料</a>','<span class="line">|</span>','<a href="'+d+'chejianguanli.html" data-id="4">车间管理</a>','<span class="line">|</span>','<a href="'+d+'kufangguanli.html" data-id="5">库房管理</a>','<span class="line">|</span>','<a href="'+d+'kehuguanli.html" data-id="6">客户管理</a>','<span class="line">|</span>','<a href="'+d+'yonghuguanli.html" data-id="7">用户管理</a>','<span class="line">|</span>','<a href="'+d+'caiwuguanli.html" data-id="8">财务管理</a>','<span class="line">|</span>','<a href="'+d+'xitongguanli.html" data-id="9">系统管理</a>','<span class="line">|</span>','<a href="'+d+'gerenyuyue.html" data-id="10">个人预约</a>',"</div>"].join(""));var m=[];e.indexOf("kehuguanli")>-1||e.indexOf("index")>-1?m.push(['<a href="javascript:;" data-id="carOwner">客户名称</a>','<a href="javascript:;" data-id="carOwnTel">电话</a>','<a href="javascript:;" data-id="carNum">车牌号</a>','<a href="javascript:;" data-id="status">状态</a>'].join("")):m.push(['<a href="javascript:;" data-id="name">客户名称</a>','<a href="javascript:;" data-id="phone">电话</a>','<a href="javascript:;" data-id="platenumber">车牌号</a>','<a href="javascript:;" data-id="status">状态</a>'].join("")),j.push(['<span class="select icons" data-id="'+(e.indexOf("kehuguanli")>-1||e.indexOf("index")>-1?"carOwner":"name")+'">客户名称</span>','<input type="text" class="inpt-search" />','<a href="javascript:;" class="btn-search" ms-click="searchItem">搜索</a>','<div class="select-box">',m,"</div>"].join("")),$("div.header").html(g.join("")),$("div.mainnav").html(i.join("")),$("div.search").html(j.join("")),$("div.footer").html(h.join("")),$("div.header").on("click","a.modifypwd",function(a){a.stopPropagation();var b=$("div.dialog-modify"),d=$("div.mask"),e=[];b.size()>0?(b.show(),d.show()):(e.push(['<div class="item">','<label>输入旧密码：</label> <input type="text" id="oldpwd" class="inpt" />','<div class="msg"></div>',"</div>",'<div class="item">','<label>输入新密码：</label> <input type="text" id="newpwd" class="inpt" />','<div class="msg"></div>',"</div>",'<div class="item">','<label>确认新密码：</label> <input type="text" id="renewpwd" class="inpt" />','<div class="msg"></div>',"</div>"].join("")),$("body").append('<div class="dialog dialog-modify"></div>'),b=$("div.dialog-modify"),b.dialog({title:"修改密码",content:e.join(""),button:[{text:"确定",cls:"btn-ok",handler:function(a){var b={ent_id:$("span.username",$("div.logined")).text(),password:$("input.oldpwd",a).val(),new_password:$("input.newpwd",a).val()};$("input",a);c(a),l.oldpwd&&l.newpwd&&$.ajax({url:f+"com.update.pwd.do",data:b,dataType:"jsonp",type:"GET",success:function(b){1==b.code&&($("div.bd",a).html("修改成功，重新登录"),setTimeout(function(){a.dialog("hide"),location.href="login.html"},2e3))}})}},{text:"取消",cls:"btn-cancel",handler:function(a){a.dialog("hide")}}],callback:function(a){a.addClass("user")}}))}).on("click","a.logout",function(a){a.stopPropagation(),COMMON.ajaxFn({url:"dologout.jsp",obj:{},callback:function(){alert("退出成功")}})});for(var n=["index","yuyuejiedai","weixiujiedai","weixiulingliao","chejianguanli","kufangguanli","kehuguanli","yonghuguanli","caiwuguanli","xitongguanli","gerenyuyue"],o=0,p=n.length;p>o;o++)e.indexOf(n[o])>0&&$("a","div.mainnav").removeClass("on").eq(o).addClass("on");a(),c(),console.log("新加的项目：注册、找回密码、推荐商品管理、雇员管理、车辆品牌管理、车辆类型管理、部门管理、供应商管理、服务商等模块"),console.log("已结5k，还有7.5k尾款未结清，不包含新添加的项目（15个页面），每页按500计算")}();