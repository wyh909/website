$(function(){var t,u,b=(window.location.href,document.location.href.indexOf("opt.html")>-1),c={pageNumber:1,pageSize:10},d=1,e=[{id:"productName",name:"商品名称"},{id:"productID",name:"商品编号"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"},{id:"lastdeliveryDate",name:"最近出货时间"},{id:"lastpurchaseDate",name:"最近进货时间"},{id:"account",name:"商品可售数量"},{id:"unit",name:"单位(升,个)"},{id:"safeaccount",name:"安全数量"},{id:"suggestBuyprice",name:"建议购买价格"},{id:"suggestSaleprice",name:"建议销售价格"},{id:"repertory",name:"仓库名称"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"}],f=[{id:"id",name:"库存单号"},{id:"productName",name:"商品名称"},{id:"productID",name:"商品编号"},{id:"account",name:"出库数量"},{id:"unit",name:"单位"},{id:"suggestBuyprice",name:"出库价格"},{id:"repertory",name:"仓库名称"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"},{id:"receive",name:"领料人"},{id:"handleMan",name:"办理人员"}],g=[{id:"name",name:"供应商名称"},{id:"address",name:"供应商地址"},{id:"contactman",name:"供应商联系人"},{id:"telephone",name:"供应商电话"},{id:"phone",name:"供应商phone"},{id:"fax",name:"供应商传真"}],h={id:"table_ccgl",itemId:"id",port:"listProductByPage.do",th:e,isOpt:!1,callback:function(a){$(".loading").hide(),$("table").attr("class","Stable").css("width","1200px"),$("#tree").on("click","a",function(){treeLink(a,$(this).html())})}},i={itemId:"id",port:"listStorageformByPage.do",delport:"deleteStorageform.do",th:f},j={itemId:"id",port:"fandDeliveryformByPage.do",delport:"deleteDeliveryform.do",th:f},k={itemId:"id",port:"listSupplierByPage.do",th:g},l={itemId:"id",port:"listSupplierByPage.do",th:g},m={itemId:"id",port:"listSupplierByPage.do",th:g},n=[{id:"id",name:"库存单号",value:""},{id:"productName",name:"商品名称",value:""},{id:"productID",name:"商品编号",value:""},{id:"account",name:"出库数量",value:""},{id:"unit",name:"单位",value:""},{id:"suggestBuyprice",name:"出库价格",value:""},{id:"repertory",name:"仓库名称",value:""},{id:"origin",name:"产地",value:""},{id:"type",name:"分类",value:""},{id:"carModle",name:"车型",value:""},{id:"receive",name:"领料人",value:""},{id:"handleMan",name:"办理人员",value:""}],o={itemId:"id",edittype:1,editurl:"listStorageformByPage.do",saveurl:"addStorageform.do",editItem:n},p={itemId:"id",edittype:1,editurl:"fandDeliveryformByPage.do",saveurl:"addDeliveryform.do",editItem:n},s=[h,i,j,k,l,m];b?(COMMON.addTpl({edit:1}),t=$("div.opt-tit"),"in"==COMMON.getQuery("orderType")?(t.html("入库单"),COMMON.edit("edit",o)):(t.html("出库单"),COMMON.edit("edit",p))):(COMMON.addTpl({table:1,th:e}),u=avalon.define("childTable",function(a){a.tab=["库存管理","入库","出库","供应商管理","估价","维修退单"],a.curIndex=0,a.th=e,a.tr=[],a.item=[],a.isCheck=s[a.curIndex].isCheck||!1,a.isOpt=s[a.curIndex].isOpt||!1,a.changeIndex=function(b){var e,f;a.curIndex=b,0==b&&(e={port:"usedCompontInput.do",obj:COMMON.defaultParam,isFold:!1},TREE.tree($("div.tree"),e)),f=s[b],a.th=f.th,COMMON.ajaxFn({url:f.port,obj:c,callback:function(b){var c,e,f,g,h;(1==b.code||1==b.ret)&&(c=b.data.data||[],a.tr=[],b.data?(c instanceof Array?a.tr=c||[]:(e=[],e.push(c),a.tr=e),0==a.curIndex?$("table").css("width","1200px"):$("table").css("width","100%"),$("tr.loading","div.tabitem").hide(),f=$("div.page"),g=b.data["total"]||"",g&&1!=g?(f.show(),h=g,f.pager({pageNumber:d,pageTotal:h,change:function(a){param.pageNum=a,getData(url,param,function(){tableModel.getNum(a)})}})):f.hide()):$("tr.loading td").html("暂无数据"))}})},a.getkey=function(a,b){return u.tr.size()>0&&u.tr[a]?u.tr[a][b]:void 0},a.getId=function(b){var d=u,e="";return 1==a.curIndex?e="&orderType=in":2==a.curIndex&&(e="&orderType=out"),d.tr.size()>0&&d.tr[b]?"kufangguanli-opt.html?id="+d.tr[b][s[b].itemId]+e:void 0},a.addItem=function(){location.href="kufangguanli-opt.html"},a.editItem=function(){},a.saveItem=function(){$dialog.dialog("show"),editDialog(u.curIndex),$("#tree").on("click","a",function(){editDialog(u.curIndex,{itemName:$(this).html()})})},a.delItem=function(b){var c=s[a.curIndex],d=a.tr[b][c.itemId];$("div.dialog").dialog({title:"窗口提示",content:"确定删除此条数据吗",button:[{text:"确定",cls:"btn-ok",handler:function(b){COMMON.ajaxFn({url:c.delport,obj:{id:d},callback:function(c){(1==c.code||1==c.ret)&&(b.dialog("hide"),a.changeIndex(a.curIndex))}})}},{text:"取消",cls:"btn-cancal",handler:function(a){a.dialog("hide")}}],callback:function(a){a.addClass("w400")}})}}),avalon.scan(),u.changeIndex(0))});