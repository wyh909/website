$(function(){var s,t,b=(window.location.href,document.location.href.indexOf("opt.html")>-1),c={pageNumber:1,pageSize:10},d=[{id:"id",name:"商品名称"},{id:"productID",name:"商品编号"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"},{id:"lastdeliveryDate",name:"最近出货时间"},{id:"lastpurchaseDate",name:"最近进货时间"},{id:"account",name:"商品可售数量"},{id:"unit",name:"单位(升,个)"},{id:"safeaccount",name:"安全数量"},{id:"suggestBuyprice",name:"建议购买价格"},{id:"suggestSaleprice",name:"建议销售价格"},{id:"repertory",name:"仓库名称"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"}],e=[{id:"id",name:"库存单号"},{id:"productName",name:"商品名称"},{id:"productID",name:"商品编号"},{id:"account",name:"出库数量"},{id:"unit",name:"单位"},{id:"suggestBuyprice",name:"出库价格"},{id:"repertory",name:"仓库名称"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"},{id:"receive",name:"领料人"},{id:"handleMan",name:"办理人员"}],f=[{id:"name",name:"供应商名称"},{id:"address",name:"供应商地址"},{id:"contactman",name:"供应商联系人"},{id:"telephone",name:"供应商电话"},{id:"phone",name:"供应商phone"},{id:"fax",name:"供应商传真"}],g={id:"table_ccgl",itemId:"id",port:"listProductByPage.do",th:d,callback:function(a){$(".loading").hide(),$("table").attr("class","Stable").css("width","1200px"),$("#tree").on("click","a",function(){treeLink(a,$(this).html())})}},h={itemId:"id",port:"listStorageformByPage.do",delport:"deleteStorageform.do",th:e},i={itemId:"id",port:"fandDeliveryformByPage.do",delport:"deleteDeliveryform.do",th:e},j={itemId:"id",port:"listSupplierByPage.do",th:f},k={itemId:"id",port:"listSupplierByPage.do",th:f},l={itemId:"id",port:"listSupplierByPage.do",th:f},m=[{id:"id",name:"库存单号",value:""},{id:"productName",name:"商品名称",value:""},{id:"productID",name:"商品编号",value:""},{id:"account",name:"出库数量",value:""},{id:"unit",name:"单位",value:""},{id:"suggestBuyprice",name:"出库价格",value:""},{id:"repertory",name:"仓库名称",value:""},{id:"origin",name:"产地",value:""},{id:"type",name:"分类",value:""},{id:"carModle",name:"车型",value:""},{id:"receive",name:"领料人",value:""},{id:"handleMan",name:"办理人员",value:""}],n={itemId:"id",edittype:1,editurl:"listStorageformByPage.do",saveurl:"addStorageform.do",editItem:m},o={itemId:"id",edittype:1,editurl:"fandDeliveryformByPage.do",saveurl:"addDeliveryform.do",editItem:m},r=[g,h,i,j,k,l];b?(COMMON.addTpl({edit:1}),s=$("div.opt-tit"),"in"==COMMON.getQuery("orderType")?(s.html("入库单"),COMMON.edit("edit",n)):(s.html("出库单"),COMMON.edit("edit",o))):(COMMON.addTpl({table:1,th:d}),t=avalon.define("childTable",function(a){a.tab=["库存管理","入库","出库","供应商管理","估价","维修退单"],a.curIndex=0,a.th=d,a.tr=[],a.item=[],a.isOpt=!0,a.changeIndex=function(b){var d,e;a.curIndex=b,0==b&&(d={port:"usedCompontInput.do",obj:COMMON.defaultParam,isFold:!1},TREE.tree($("div.tree"),d)),e=r[b],a.th=e.th,COMMON.ajaxFn({url:e.port,obj:c,callback:function(b){var c,d;(1==b.code||1==b.ret)&&(c=b.data.data||[],a.tr=[],b.data?(c instanceof Array?a.tr=c||[]:(d=[],d.push(c),a.tr=d),0==a.curIndex?$("table").css("width","1200px"):$("table").css("width","100%"),$("tr.loading","div.item").hide()):$("tr.loading td").html("暂无数据"))}})},a.getkey=function(a,b){return t.tr.size()>0&&t.tr[a]?t.tr[a][b]:void 0},a.getId=function(b){var d=t,e="";return 1==a.curIndex?e="&orderType=in":2==a.curIndex&&(e="&orderType=out"),d.tr.size()>0&&d.tr[b]?"kufangguanli-opt.html?id="+d.tr[b][r[b].itemId]+e:void 0},a.editItem=function(){},a.saveItem=function(){$dialog.dialog("show"),editDialog(t.curIndex),$("#tree").on("click","a",function(){editDialog(t.curIndex,{itemName:$(this).html()})})},a.delItem=function(b){var c=r[a.curIndex],d=a.tr[b][c.itemId];$("div.dialog").dialog({title:"窗口提示",content:"确定删除此条数据吗",button:[{text:"确定",cls:"btn-ok",handler:function(b){COMMON.ajaxFn({url:c.delport,obj:{id:d},callback:function(c){(1==c.code||1==c.ret)&&(b.dialog("hide"),a.changeIndex(a.curIndex))}})}},{text:"取消",cls:"btn-cancal",handler:function(a){a.dialog("hide")}}],callback:function(a){a.addClass("w400")}})}}),avalon.scan(),t.changeIndex(0))});