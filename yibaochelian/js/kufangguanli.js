$(function(){var y,z,A,b=(window.location.href,document.location.href.indexOf("opt.html")>-1),c={pageNumber:1,pageSize:10},d=1,e=[{id:"productName",name:"商品名称"},{id:"productID",name:"商品编号"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"},{id:"lastdeliveryDate",name:"最近出货时间"},{id:"lastpurchaseDate",name:"最近进货时间"},{id:"account",name:"商品可售数量"},{id:"unit",name:"单位(升,个)"},{id:"safeaccount",name:"安全数量"},{id:"suggestBuyprice",name:"建议购买价格"},{id:"suggestSaleprice",name:"建议销售价格"},{id:"repertory",name:"仓库名称"}],f=[{id:"id",name:"入库单ID"},{id:"productName",name:"商品名称"},{id:"productID",name:"商品编号"},{id:"account",name:"商品数量"},{id:"unit",name:"单位"},{id:"price",name:"进价"},{id:"saleprice",name:"售价"},{id:"repertory",name:"仓库名称"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"},{id:"handelMan",name:"办理人员"},{id:"supplierID",name:"供应商ID"}],g=[{id:"id",name:"库存单号"},{id:"productName",name:"商品名称"},{id:"productID",name:"商品编号"},{id:"account",name:"出库数量"},{id:"unit",name:"单位"},{id:"suggestBuyprice",name:"出库价格"},{id:"repertory",name:"仓库名称"},{id:"origin",name:"产地"},{id:"type",name:"分类"},{id:"carModle",name:"车型"},{id:"receive",name:"领料人"},{id:"handleMan",name:"办理人员"}],h=[{id:"name",name:"供应商名称"},{id:"address",name:"供应商地址"},{id:"contactman",name:"供应商联系人"},{id:"telephone",name:"供应商电话"},{id:"phone",name:"供应商phone"},{id:"fax",name:"供应商传真"}],i=[{id:"recommendItemID",name:"套餐id"},{id:"pageName",name:"套餐名称"},{id:"milesMin",name:"最小里程数"},{id:"milesMax",name:"最大里程数"},{id:"brand",name:"车辆品牌"},{id:"series",name:"车系"},{id:"items",name:"推荐项目号ids"},{id:"products",name:"产品ids"}],j=[{id:"orderNum",name:"退货单号"},{id:"fillDate",name:"填写日期"},{id:"teams",name:"班组"},{id:"employee",name:"领料员"},{id:"depotManager",name:"仓管员"},{id:"maintainforNum",name:"维修单号"},{id:"carOwner",name:"客户姓名"}],k={id:"table_ccgl",itemId:"id",port:"listProductByPage.do",th:e,callback:function(a){$("#tree").on("click","a",function(){treeLink(a,$(this).html())})}},l={itemId:"id",port:"listStorageformByPage.do",addport:"addStorageform.do",delport:"deleteStorageform.do",th:f},m={itemId:"id",port:"fandDeliveryformByPage.do",addport:"addDeliveryform.do",delport:"deleteDeliveryform.do",th:g},n={itemId:"id",port:"listSupplierByPage.do",th:h},o={itemId:"recommendItemID",port:"recommendItemList.do",delport:"deleterecommendItemById.do",th:i},p={itemId:"orderNum",port:"listMaterialByPage.do",th:j},q=[{id:"productName",name:"商品名称",value:""},{id:"productID",name:"商品编号",value:""},{id:"account",name:"商品数量",value:""},{id:"unit",name:"单位",value:""},{id:"price",name:"进价",value:""},{id:"saleprice",name:"售价",value:""},{id:"repertory",name:"仓库名称",value:""},{id:"origin",name:"产地",value:""},{id:"type",name:"分类",value:""},{id:"carModle",name:"车型",value:""},{id:"handelMan",name:"办理人员",value:""},{id:"supplierID",name:"供应商ID",value:""}],r=[{id:"productName",name:"商品名称",value:""},{id:"productID",name:"商品编号",value:""},{id:"account",name:"出库数量",value:""},{id:"unit",name:"单位",value:""},{id:"suggestBuyprice",name:"出库价格",value:""},{id:"repertory",name:"仓库名称",value:""},{id:"origin",name:"产地",value:""},{id:"type",name:"分类",value:""},{id:"carModle",name:"车型",value:""},{id:"receive",name:"领料人",value:""},{id:"handleMan",name:"办理人员",value:""}],s={itemId:"id",edittype:1,editurl:"listStorageformByPage.do",saveurl:"addStorageform.do",editItem:q},t={itemId:"id",edittype:1,editurl:"fandDeliveryformByPage.do",saveurl:"addDeliveryform.do",editItem:r},u={itemId:"id",edittype:1,editurl:"fandDeliveryformByPage.do",saveurl:"addDeliveryform.do",editItem:[{id:"name",name:"供应商名称",value:""},{id:"address",name:"供应商地址",value:""},{id:"contactman",name:"供应商联系人",value:""},{id:"telephone",name:"供应商电话",value:""},{id:"phone",name:"供应商phone",value:""},{id:"fax",name:"供应商传真",value:""}]},v={itemId:"id",edittype:1,editurl:"recommendItemList.do",saveurl:"savedrecommendItem.do",editItem:[{id:"recommendItemID",name:"套餐id",value:""},{id:"pageName",name:"套餐名称",value:""},{id:"milesMin",name:"最小里程数",value:""},{id:"milesMax",name:"最大里程数",value:""},{id:"brand",name:"车辆品牌",value:""},{id:"series",name:"车系",value:""},{id:"items",name:"推荐项目号ids",value:""},{id:"products",name:"产品ids",value:""}]},w={itemId:"orderNum",edittype:1,editurl:"listMaterialByPage.do",saveurl:"materialReturnSaveOrUpdate.do",editItem:[{id:"id",name:"领料单id",value:""},{id:"orderNum",name:"领料单号",value:""},{id:"fillDate",name:"填写日期",value:""},{id:"maintainforNum",name:"维修单号",value:""},{id:"carOwner",name:"客户姓名",value:""},{id:"merchandiser",name:"开单员",value:""},{id:"identityNum",name:"识别号",value:""},{id:"plateNumber",name:"车牌号码",value:""},{id:"teams",name:"班组",value:""},{id:"employee",name:"领料员",value:""},{id:"depotManager",name:"仓管员",value:""},{id:"priceScheme",name:"售价方案",value:""},{id:"note",name:"备注",value:""},{id:"totalNum",name:"数量合计",value:""},{id:"saleAmount",name:"销售金额",value:""},{id:"capitalAmount",name:"大写金额",value:""},{id:"auditor",name:"审核员",value:""},{id:"auditDate",name:"审核日期,",value:""},{id:"returnMaterialType",name:"退货类型,",value:""},{id:"returnMaterialReason",name:"退货原因",value:""}],callback:function(){for(var a=0,b=$("input[type=text]").length-2;b>a;a++)$("input[type=text]").eq(a).attr("disabled","disabled")}},x=[k,l,m,n,o,p];b?(COMMON.addTpl({edit:1}),y=$("div.opt-tit"),z=COMMON.getQuery("type"),1==z?(y.html("入库单"),COMMON.edit("edit",s)):2==z?(y.html("出库单"),COMMON.edit("edit",t)):3==z?(y.html("供应商管理"),COMMON.edit("edit",u)):4==z?(y.html("估价"),COMMON.edit("edit",v)):5==z&&(y.html("维修退单"),COMMON.edit("edit",w))):(COMMON.addTpl({table:1,th:[]}),A=avalon.define("childTable",function(a){a.tab=["库存管理","入库","出库","供应商管理","估价","维修退单"],a.curIndex=0,a.th=[],a.tr=[],a.item=[],a.nodata='<img src="img/loading.gif"/>',a.isCheck=!1,a.isOpt=!0,a.changeIndex=function(b){var e,f;a.curIndex=b,console.log(x[a.curIndex].isOpt),0==b&&(e={port:"usedCompontInput.do",obj:COMMON.defaultParam,isFold:!1},TREE.tree($("div.tree"),e)),f=x[b],a.th=[],a.th=f.th,COMMON.ajaxFn({url:f.port,obj:c,callback:function(b){var c,e,f,g,h,i,j,k;if(1==b.code||1==b.ret)if(c=b.data.data||[],a.tr=[],b.data){if(c instanceof Array?c.length<1?(a.nodata="暂无数据",$("tr.loading","div.tabitem").show()):(a.tr=c||[],$("tr.loading","div.tabitem").hide()):(e=[],e.push(c),a.tr=e,$("tr.loading","div.tabitem").hide()),0==a.curIndex)for($("table").css("width","1200px"),$("tr","table").find("th:last").hide(),f=0,g=$("tr","table").length;g>f;f++)$("tr","table").find("td:last").hide();else 5==a.curIndex?($("table").css("width","100%"),$("a.delete-item").hide()):($("table").css("width","100%"),$("tr","table").find("th:last").show());h=x[a.curIndex],h.callback&&"function"==typeof h.callback&&h.callback(),i=$("div.page"),j=b.data["total"]||"",j&&1!=j?(i.show(),k=j,i.pager({pageNumber:d,pageTotal:k,change:function(a){param.pageNum=a,getData(url,param,function(){tableModel.getNum(a)})}})):i.hide()}else a.nodata="暂无数据",$("tr.loading","div.tabitem").show()}})},a.getkey=function(a,b){return A.tr.size()>0&&A.tr[a]?A.tr[a][b]:void 0},a.getId=function(b){var d=A;return d.tr.size()>0&&d.tr[b]?"kufangguanli-opt.html?id="+d.tr[b][x[d.curIndex].itemId]+"&type="+a.curIndex:void 0},a.addItem=function(){location.href="kufangguanli-opt.html?type="+a.curIndex},a.editItem=function(){},a.saveItem=function(){$dialog.dialog("show"),editDialog(A.curIndex),$("#tree").on("click","a",function(){editDialog(A.curIndex,{itemName:$(this).html()})})},a.delItem=function(b){var c=x[a.curIndex],d=a.tr[b][c.itemId];$("div.dialog").dialog({title:"窗口提示",content:"确定删除此条数据吗",button:[{text:"确定",cls:"btn-ok",handler:function(b){COMMON.ajaxFn({url:c.delport,obj:{id:d},callback:function(c){(1==c.code||1==c.ret)&&(b.dialog("hide"),a.changeIndex(a.curIndex))}})}},{text:"取消",cls:"btn-cancal",handler:function(a){a.dialog("hide")}}],callback:function(a){a.addClass("w400")}})},a.searchItem=function(b){var f,g,c=$(b.target),d=c.siblings("input[type=text]"),e={};for(f=0,g=d.length;g>f;f++)e[d.eq(f).attr("data-id")]=d.eq(f).val();COMMON.ajaxFn({url:x[a.curIndex].port,obj:e,callback:function(b){if(1===b.code)if(b.data){var c=b.data;c.length>0?a.tr=c:c.data?a.tr=c.data:a.nodata="没有搜到数据"}else a.nodata="没有搜到数据"}})}}),avalon.scan(),COMMON.getQuery("type")?A.changeIndex(parseInt(COMMON.getQuery("type"))||0):A.changeIndex(0))});